<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Padlet Scuola - Through Our Eyes</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .note { transition: all 0.3s ease; }
        .note:hover { transform: translateY(-2px); }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // ========== CONFIGURAZIONE ==========
        //MODIFICA QUESTI VALORI CON I TUOI DATI
        const CONFIG = {
            GITHUB: {
                token: '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',      // SOSTITUISCI con il tuo token
                owner: 'DanCar-Dev',              // SOSTITUISCI con il tuo username GitHub
                repo: 'Bacheca',              // SOSTITUISCI con il nome della repository
                branch: 'main',
                dataFile: 'data.json'
            },
            USERS: {
                'daniele': { password: 'Framework', role: 'admin', name: 'Daniele' },
                'antonella': { password: 'scottlove', role: 'admin', name: 'Prof. Antonella' },
                'studente': { password: 'studente123', role: 'editor', name: 'Studente' }
            }
        };

        // ========== ICONE SVG ==========
        const Plus = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );
        
        const X = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );
        
        const ImageIcon = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
        );
        
        const GoogleDriveIcon = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="currentColor">
                <path d="M7.71,3.5L1.15,15L4.58,21L11.13,9.5L7.71,3.5M9.73,15L6.3,21H19.42L22.85,15H9.73M22.28,14L15.42,2H8.58L8.57,2L15.43,14H22.28Z"/>
            </svg>
        );
        
        const SyncIcon = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
        );

        // ========== COMPONENTE PRINCIPALE ==========
        function PadletBoard() {
            // Stati
            const [notes, setNotes] = useState([]);
            const [isAdding, setIsAdding] = useState(false);
            const [newNote, setNewNote] = useState({ 
                title: '', 
                content: '', 
                color: '#fef3c7', 
                image: null 
            });
            
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);
            const [showLogin, setShowLogin] = useState(false);
            const [loginUsername, setLoginUsername] = useState('');
            const [loginPassword, setLoginPassword] = useState('');
            
            const [boardTitle, setBoardTitle] = useState('Through Our Eyes: Famous Paintings Unveiled');
            const [boardDescription, setBoardDescription] = useState('In this board, each student describes and analyzes a famous painting. Share your thoughts!');
            
            const [isSyncing, setIsSyncing] = useState(false);
            const [lastSync, setLastSync] = useState(null);
            const [syncStatus, setSyncStatus] = useState('Pronto');
            
            const colors = [
                { name: 'Giallo', value: '#fef3c7' },
                { name: 'Rosa', value: '#fce7f3' },
                { name: 'Blu', value: '#dbeafe' },
                { name: 'Verde', value: '#d1fae5' },
                { name: 'Viola', value: '#ede9fe' },
                { name: 'Arancione', value: '#fed7aa' }
            ];

            // ========== EFFETTI ==========
            useEffect(() => {
                loadNotesFromGitHub();
            }, []);

            // ========== FUNZIONI GITHUB ==========
            const saveNotesToGitHub = async (updatedNotes, updateTitle = null, updateDesc = null) => {
                setIsSyncing(true);
                setSyncStatus('Salvataggio in corso...');
                
                try {
                    // 1. Prepara dati
                    const data = {
                        notes: updatedNotes.map(note => ({
                            ...note,
                            // Rimuovi immagini Base64 (troppo grandi)
                            image: note.image && note.image.startsWith('data:') ? null : note.image
                        })),
                        title: updateTitle || boardTitle,
                        description: updateDesc || boardDescription,
                        lastUpdated: new Date().toISOString(),
                        totalNotes: updatedNotes.length,
                        updatedBy: currentUser?.username || 'system'
                    };
                    
                    // 2. Ottieni SHA se il file esiste
                    let sha = null;
                    try {
                        const shaResponse = await fetch(
                            `https://api.github.com/repos/${CONFIG.GITHUB.owner}/${CONFIG.GITHUB.repo}/contents/${CONFIG.GITHUB.dataFile}`,
                            { headers: { 'Authorization': `token ${CONFIG.GITHUB.token}` } }
                        );
                        if (shaResponse.ok) {
                            const shaData = await shaResponse.json();
                            sha = shaData.sha;
                        }
                    } catch (e) {
                        // File non esiste ancora
                    }
                    
                    // 3. Converti in Base64
                    const contentBase64 = btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2))));
                    
                    // 4. Salva su GitHub
                    const response = await fetch(
                        `https://api.github.com/repos/${CONFIG.GITHUB.owner}/${CONFIG.GITHUB.repo}/contents/${CONFIG.GITHUB.dataFile}`,
                        {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${CONFIG.GITHUB.token}`,
                                'Content-Type': 'application/json',
                                'Accept': 'application/vnd.github.v3+json'
                            },
                            body: JSON.stringify({
                                message: `Aggiornamento Padlet - ${new Date().toLocaleString('it-IT')}`,
                                content: contentBase64,
                                sha: sha,
                                branch: CONFIG.GITHUB.branch
                            })
                        }
                    );
                    
                    if (!response.ok) {
                        const error = await response.json();
                        throw new Error(error.message || 'Errore salvataggio');
                    }
                    
                    setLastSync(new Date().toISOString());
                    setSyncStatus('Salvato con successo!');
                    
                    // Salva anche in locale come cache
                    saveToLocalStorage(updatedNotes);
                    
                    return true;
                    
                } catch (error) {
                    console.error('‚ùå Errore GitHub:', error);
                    setSyncStatus('Errore: ' + error.message);
                    throw error;
                } finally {
                    setIsSyncing(false);
                    setTimeout(() => setSyncStatus('Pronto'), 3000);
                }
            };

            const loadNotesFromGitHub = async () => {
                setIsSyncing(true);
                setSyncStatus('Caricamento in corso...');
                
                try {
                    // URL pubblico (nessun token)
                    const url = `https://raw.githubusercontent.com/${CONFIG.GITHUB.owner}/${CONFIG.GITHUB.repo}/${CONFIG.GITHUB.branch}/${CONFIG.GITHUB.dataFile}?t=${Date.now()}`;
                    
                    const response = await fetch(url);
                    
                    if (response.ok) {
                        const data = await response.json();
                        setNotes(data.notes || []);
                        setBoardTitle(data.title || 'Through Our Eyes');
                        setBoardDescription(data.description || '');
                        setLastSync(data.lastUpdated || null);
                        setSyncStatus(`Caricate ${data.notes?.length || 0} note`);
                        
                        // Salva in locale come cache
                        saveToLocalStorage(data.notes || []);
                        
                        return true;
                    } else {
                        throw new Error('File non trovato');
                    }
                } catch (error) {
                    console.log('‚ö†Ô∏è Usando dati locali:', error.message);
                    loadFromLocalStorage();
                    setSyncStatus('Usando dati locali');
                    return false;
                } finally {
                    setIsSyncing(false);
                    setTimeout(() => setSyncStatus('Pronto'), 3000);
                }
            };

            // ========== LOCALSTORAGE ==========
            const saveToLocalStorage = (updatedNotes) => {
                try {
                    localStorage.setItem('padlet-notes', JSON.stringify(updatedNotes));
                    localStorage.setItem('board-title', boardTitle);
                    localStorage.setItem('board-description', boardDescription);
                } catch (e) {
                    console.error('Errore localStorage:', e);
                }
            };

            const loadFromLocalStorage = () => {
                try {
                    const savedNotes = localStorage.getItem('padlet-notes');
                    const savedTitle = localStorage.getItem('board-title');
                    const savedDesc = localStorage.getItem('board-description');
                    
                    if (savedNotes) setNotes(JSON.parse(savedNotes));
                    if (savedTitle) setBoardTitle(savedTitle);
                    if (savedDesc) setBoardDescription(savedDesc);
                } catch (e) {
                    console.error('Errore caricamento locale:', e);
                }
            };

            // ========== GESTIONE IMMAGINI ==========
            const handleGoogleDriveImage = () => {
                const driveUrl = prompt(
                    'üñºÔ∏è COLLEGA FOTO DA GOOGLE DRIVE\n\n' +
                    'PASSAGGI:\n' +
                    '1. Carica la foto su drive.google.com\n' +
                    '2. Click destro ‚Üí "Condividi"\n' +
                    '3. Seleziona "Chiunque con il link"\n' +
                    '4. Copia il link e incollalo qui:\n\n' +
                    'Incolla il link Google Drive:',
                    'https://drive.google.com/file/d/...'
                );
                
                if (!driveUrl || !driveUrl.trim()) return;
                
                // Estrai ID da vari formati
                let fileId = '';
                const url = driveUrl.trim();
                
                if (url.includes('/file/d/')) {
                    fileId = url.split('/file/d/')[1].split('/')[0];
                } else if (url.includes('id=')) {
                    fileId = url.split('id=')[1].split('&')[0];
                } else if (url.match(/[-\w]{25,}/)) {
                    fileId = url.match(/[-\w]{25,}/)[0];
                }
                
                if (fileId) {
                    const directUrl = `https://drive.google.com/uc?export=view&id=${fileId}`;
                    setNewNote({ ...newNote, image: directUrl });
                    alert('‚úÖ Foto collegata correttamente!\nTutti potranno vederla.');
                } else {
                    alert('‚ùå Link non valido!\nAssicurati di copiare il link completo da Google Drive.');
                }
            };

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                if (!file.type.startsWith('image/')) {
                    alert('Seleziona solo file immagine (JPG, PNG, etc.)');
                    return;
                }
                
                const useDrive = confirm(
                    'ATTENZIONE!\n\n' +
                    'Caricare foto dal computer:\n' +
                    '‚ùå SOLO TU la vedrai su QUESTO computer\n\n' +
                    'Per condividere con TUTTI:\n' +
                    '‚úÖ Usa Google Drive (consigliato)\n\n' +
                    '[OK] = Uso Google Drive\n' +
                    '[Annulla] = Carica solo localmente'
                );
                
                if (useDrive) {
                    handleGoogleDriveImage();
                } else {
                    // Preview locale
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setNewNote({ ...newNote, image: reader.result });
                    };
                    reader.readAsDataURL(file);
                    
                    alert('‚ö†Ô∏è Questa foto sar√† visibile SOLO su questo computer!');
                }
            };

            // ========== OPERAZIONI NOTE ==========
            const addNote = async () => {
                if (!newNote.title.trim() && !newNote.content.trim() && !newNote.image) {
                    alert('Inserisci almeno un titolo, contenuto o immagine');
                    return;
                }
                
                const note = {
                    ...newNote,
                    id: Date.now(),
                    x: Math.random() * 70,
                    y: Math.random() * 30,
                    createdAt: new Date().toISOString(),
                    createdBy: currentUser?.name || 'Anonimo'
                };
                
                const updatedNotes = [...notes, note];
                setNotes(updatedNotes);
                
                try {
                    if (currentUser?.role === 'admin') {
                        await saveNotesToGitHub(updatedNotes);
                        alert('‚úÖ Nota salvata e visibile a TUTTI!');
                    } else {
                        saveToLocalStorage(updatedNotes);
                        alert('‚ö†Ô∏è Nota salvata solo localmente. Solo gli admin possono salvare per tutti.');
                    }
                } catch (error) {
                    saveToLocalStorage(updatedNotes);
                    alert('‚ùå Errore di connessione. Nota salvata solo localmente.');
                }
                
                setNewNote({ title: '', content: '', color: '#fef3c7', image: null });
                setIsAdding(false);
            };

            const deleteNote = async (id) => {
                if (!confirm('Sei sicuro di voler eliminare questa nota?')) return;
                
                const updatedNotes = notes.filter(n => n.id !== id);
                setNotes(updatedNotes);
                
                try {
                    if (currentUser?.role === 'admin') {
                        await saveNotesToGitHub(updatedNotes);
                        alert('Nota eliminata per tutti');
                    } else {
                        saveToLocalStorage(updatedNotes);
                        alert('Nota eliminata solo localmente');
                    }
                } catch (error) {
                    saveToLocalStorage(updatedNotes);
                    alert('Nota eliminata solo localmente');
                }
            };

            // ========== LOGIN ==========
            const handleLogin = () => {
                const usernameLower = loginUsername.toLowerCase().trim();
                const user = CONFIG.USERS[usernameLower];
                
                if (user && user.password === loginPassword) {
                    setCurrentUser({ username: usernameLower, ...user });
                    setIsLoggedIn(true);
                    setShowLogin(false);
                    setLoginUsername('');
                    setLoginPassword('');
                    
                    // Se √® admin, sincronizza con GitHub
                    if (user.role === 'admin') {
                        loadNotesFromGitHub();
                    }
                } else {
                    alert('‚ùå Username o password errati!');
                    setLoginPassword('');
                }
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                setCurrentUser(null);
                alert('Logout effettuato');
            };

            // ========== RENDER ==========
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                    {/* Header */}
                    <div className="p-6">
                        <div className="flex justify-between items-start mb-6">
                            <div className="flex-1">
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">{boardTitle}</h1>
                                <p className="text-gray-600">{boardDescription}</p>
                                
                                <div className="flex items-center gap-4 mt-3">
                                    <div className="text-sm">
                                        <span className={`px-2 py-1 rounded ${isSyncing ? 'bg-yellow-100 text-yellow-800' : 'bg-green-100 text-green-800'}`}>
                                            {isSyncing ? 'üîÑ ' : '‚úÖ '}{syncStatus}
                                        </span>
                                        {lastSync && (
                                            <span className="ml-3 text-gray-500">
                                                Aggiornato: {new Date(lastSync).toLocaleString('it-IT')}
                                            </span>
                                        )}
                                    </div>
                                    
                                    <button
                                        onClick={loadNotesFromGitHub}
                                        disabled={isSyncing}
                                        className={`flex items-center gap-2 px-4 py-2 rounded-lg ${isSyncing ? 'bg-gray-400' : 'bg-blue-600 hover:bg-blue-700'} text-white`}
                                    >
                                        <SyncIcon size={18} className={isSyncing ? 'animate-spin' : ''} />
                                        {isSyncing ? 'Sinc...' : 'Sincronizza'}
                                    </button>
                                </div>
                            </div>
                            
                            <div className="flex gap-3">
                                {isLoggedIn ? (
                                    <>
                                        <div className="px-4 py-2 bg-green-100 text-green-800 rounded-lg">
                                            <div className="font-semibold">{currentUser.name}</div>
                                            <div className="text-xs">({currentUser.role})</div>
                                        </div>
                                        <button
                                            onClick={handleLogout}
                                            className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                                        >
                                            Logout
                                        </button>
                                    </>
                                ) : (
                                    <button
                                        onClick={() => setShowLogin(true)}
                                        className="px-6 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900"
                                    >
                                        Login Docenti
                                    </button>
                                )}
                            </div>
                        </div>

                        {/* Pulsante Nuova Nota */}
                        {isLoggedIn && (
                            <div className="text-center mb-8">
                                <button
                                    onClick={() => setIsAdding(!isAdding)}
                                    className="px-8 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 shadow-lg flex items-center gap-2 mx-auto"
                                >
                                    <Plus size={20} />
                                    {isAdding ? 'Annulla' : 'Nuova Nota'}
                                </button>
                            </div>
                        )}

                        {/* Form Nuova Nota */}
                        {isAdding && isLoggedIn && (
                            <div className="max-w-2xl mx-auto bg-white rounded-xl shadow-2xl p-6 mb-8">
                                <h2 className="text-2xl font-bold mb-6 text-center">Crea Nuova Nota</h2>
                                
                                <div className="space-y-4">
                                    <input
                                        type="text"
                                        placeholder="Titolo della nota"
                                        value={newNote.title}
                                        onChange={(e) => setNewNote({...newNote, title: e.target.value})}
                                        className="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none"
                                    />
                                    
                                    <textarea
                                        placeholder="Scrivi qui la tua analisi del dipinto..."
                                        value={newNote.content}
                                        onChange={(e) => setNewNote({...newNote, content: e.target.value})}
                                        className="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none h-40 resize-none"
                                    />
                                    
                                    {/* Sezione Immagini */}
                                    <div className="border-2 border-dashed border-gray-300 rounded-xl p-6">
                                        <p className="font-semibold text-gray-700 mb-4">Immagine del dipinto:</p>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            {/* Google Drive */}
                                            <button
                                                type="button"
                                                onClick={handleGoogleDriveImage}
                                                className="p-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition flex flex-col items-center justify-center h-32"
                                            >
                                                <GoogleDriveIcon size={32} className="mb-2" />
                                                <span className="font-semibold">Google Drive</span>
                                                <span className="text-sm opacity-90">(Consigliato)</span>
                                            </button>
                                            
                                            {/* Carica locale */}
                                            <label className="p-4 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-xl hover:from-gray-600 hover:to-gray-700 transition flex flex-col items-center justify-center h-32 cursor-pointer">
                                                <ImageIcon size={32} className="mb-2" />
                                                <span className="font-semibold">Carica dal PC</span>
                                                <span className="text-sm opacity-90">(Solo locale)</span>
                                                <input
                                                    type="file"
                                                    accept="image/*"
                                                    onChange={handleImageUpload}
                                                    className="hidden"
                                                />
                                            </label>
                                        </div>
                                        
                                        {/* Istruzioni */}
                                        <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                            <p className="font-semibold text-blue-800 mb-2">üìö Per condividere con tutti:</p>
                                            <ol className="text-sm text-blue-700 list-decimal pl-5 space-y-1">
                                                <li>Carica la foto su <a href="https://drive.google.com" target="_blank" className="underline font-semibold">Google Drive</a></li>
                                                <li>Click destro ‚Üí "Condividi" ‚Üí "Chiunque con il link"</li>
                                                <li>Copia il link e incollalo quando richiesto</li>
                                            </ol>
                                        </div>
                                        
                                        {/* Anteprima */}
                                        {newNote.image && (
                                            <div className="mt-6 p-4 bg-gray-50 rounded-xl">
                                                <p className="font-semibold mb-3">Anteprima:</p>
                                                <div className="relative">
                                                    <img 
                                                        src={newNote.image} 
                                                        alt="Anteprima" 
                                                        className="max-w-full max-h-64 rounded-lg mx-auto"
                                                    />
                                                    <button
                                                        onClick={() => setNewNote({...newNote, image: null})}
                                                        className="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full hover:bg-red-600"
                                                    >
                                                        <X size={16} />
                                                    </button>
                                                </div>
                                                <p className={`text-sm mt-2 text-center ${newNote.image.includes('drive.google.com') ? 'text-green-600' : 'text-yellow-600'}`}>
                                                    {newNote.image.includes('drive.google.com') 
                                                        ? '‚úÖ Immagine condivisa (tutti la vedranno)' 
                                                        : '‚ö† Immagine locale (solo su questo PC)'}
                                                </p>
                                            </div>
                                        )}
                                    </div>
                                    
                                    {/* Colori */}
                                    <div>
                                        <p className="font-semibold text-gray-700 mb-3">Colore sfondo:</p>
                                        <div className="flex flex-wrap gap-3">
                                            {colors.map(color => (
                                                <button
                                                    key={color.value}
                                                    onClick={() => setNewNote({...newNote, color: color.value})}
                                                    className={`w-12 h-12 rounded-full border-4 ${newNote.color === color.value ? 'border-gray-800 scale-110' : 'border-white'} shadow-lg transition-transform`}
                                                    style={{backgroundColor: color.value}}
                                                    title={color.name}
                                                />
                                            ))}
                                        </div>
                                    </div>
                                    
                                    {/* Pulsanti */}
                                    <div className="flex gap-4 pt-4">
                                        <button
                                            onClick={addNote}
                                            className="flex-1 py-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 font-semibold text-lg"
                                        >
                                            üé® SALVA NOTA
                                        </button>
                                        <button
                                            onClick={() => setIsAdding(false)}
                                            className="flex-1 py-4 bg-gradient-to-r from-gray-400 to-gray-500 text-white rounded-xl hover:from-gray-500 hover:to-gray-600 font-semibold text-lg"
                                        >
                                            ANNULLA
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Messaggio per non loggati */}
                        {!isLoggedIn && (
                            <div className="bg-yellow-50 border border-yellow-200 rounded-xl p-6 mb-8 max-w-2xl mx-auto text-center">
                                <h3 className="text-xl font-bold text-yellow-800 mb-2">üëã Benvenuto!</h3>
                                <p className="text-yellow-700 mb-4">
                                    Stai visualizzando la bacheca in modalit√† lettura. 
                                    Effettua il login come docente per aggiungere nuove note.
                                </p>
                                <button
                                    onClick={() => setShowLogin(true)}
                                    className="px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"
                                >
                                    Accedi come Docente
                                </button>
                            </div>
                        )}

                        {/* Bacheca */}
                        <div className="relative bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-xl p-6 min-h-[800px] border border-gray-200">
                            {notes.length === 0 ? (
                                <div className="absolute inset-0 flex flex-col items-center justify-center text-gray-400">
                                    <div className="text-6xl mb-4">üé®</div>
                                    <p className="text-2xl font-semibold mb-2">La bacheca √® vuota</p>
                                    <p className="text-lg">Effettua il login e crea la prima nota!</p>
                                </div>
                            ) : (
                                notes.map(note => (
                                    <div
                                        key={note.id}
                                        className="absolute note rounded-2xl shadow-xl overflow-hidden"
                                        style={{
                                            backgroundColor: note.color,
                                            left: `${note.x}%`,
                                            top: `${note.y}%`,
                                            width: '300px',
                                            maxWidth: '90vw'
                                        }}
                                    >
                                        {/* Immagine */}
                                        {note.image && (
                                            <div className="relative">
                                                <img 
                                                    src={note.image} 
                                                    alt={note.title} 
                                                    className="w-full h-56 object-cover"
                                                />
                                                {note.image.includes('drive.google.com') && (
                                                    <div className="absolute top-2 right-2 bg-green-600 text-white text-xs px-3 py-1 rounded-full flex items-center gap-1">
                                                        <GoogleDriveIcon size={12} />
                                                        <span>Google Drive</span>
                                                    </div>
                                                )}
                                            </div>
                                        )}
                                        
                                        {/* Contenuto */}
                                        <div className="p-5">
                                            {note.title && (
                                                <h3 className="text-xl font-bold text-gray-800 mb-3">{note.title}</h3>
                                            )}
                                            
                                            {note.content && (
                                                <div className="text-gray-700 mb-4 whitespace-pre-wrap bg-white/50 p-3 rounded-lg">
                                                    {note.content}
                                                </div>
                                            )}
                                            
                                            {/* Metadati e azioni */}
                                            <div className="flex justify-between items-center pt-3 border-t border-gray-200/50">
                                                <div className="text-xs text-gray-500">
                                                    <div>{note.createdBy}</div>
                                                    <div>{new Date(note.createdAt).toLocaleDateString('it-IT')}</div>
                                                </div>
                                                
                                                {isLoggedIn && (currentUser?.role === 'admin' || currentUser?.role === 'editor') && (
                                                    <button
                                                        onClick={() => deleteNote(note.id)}
                                                        className="text-red-600 hover:text-red-800 text-sm font-semibold"
                                                    >
                                                        Elimina
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                        
                        {/* Footer */}
                        <div className="mt-8 pt-6 border-t border-gray-300 text-center text-gray-600 text-sm">
                            <p>üé® <strong>Padlet Scuola</strong> - Bacheca collaborativa per analisi di dipinti</p>
                            <p className="mt-1">Utilizza Google Drive per condividere immagini con tutta la classe</p>
                        </div>
                    </div>

                    {/* Modal Login */}
                    {showLogin && (
                        <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                                <div className="text-center mb-8">
                                    <div className="text-4xl mb-4">üîê</div>
                                    <h2 className="text-3xl font-bold text-gray-800">Accesso Docenti</h2>
                                    <p className="text-gray-600 mt-2">Inserisci le credenziali per accedere</p>
                                </div>
                                
                                <div className="space-y-6">
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">
                                            Username
                                        </label>
                                        <input
                                            type="text"
                                            value={loginUsername}
                                            onChange={(e) => setLoginUsername(e.target.value)}
                                            placeholder="Inserisci username"
                                            className="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none"
                                            autoFocus
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">
                                            Password
                                        </label>
                                        <input
                                            type="password"
                                            value={loginPassword}
                                            onChange={(e) => setLoginPassword(e.target.value)}
                                            onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                            placeholder="Inserisci password"
                                            className="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none"
                                        />
                                    </div>
                                    
                                    <div className="flex gap-4">
                                        <button
                                            onClick={handleLogin}
                                            className="flex-1 py-4 bg-gradient-to-r from-indigo-600 to-indigo-700 text-white rounded-xl hover:from-indigo-700 hover:to-indigo-800 font-semibold"
                                        >
                                            ACCEDI
                                        </button>
                                        <button
                                            onClick={() => setShowLogin(false)}
                                            className="flex-1 py-4 bg-gradient-to-r from-gray-400 to-gray-500 text-white rounded-xl hover:from-gray-500 hover:to-gray-600 font-semibold"
                                        >
                                            ANNULLA
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="mt-8 pt-6 border-t border-gray-200">
                                    <p className="text-sm text-gray-500 text-center">
                                        Accesso riservato al personale docente autorizzato
                                    </p>
                                    <p className="text-xs text-gray-400 mt-2 text-center">
                                        Problemi di accesso? Contatta l'amministratore
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<PadletBoard />, document.getElementById('root'));
    </script>
</body>
</html>
